[["boxplots.html", "3.14 Boxplots", " 3.14 Boxplots So far, we have learned two ways to visualize a continuous variable, namely the histograms (Section 3.12) and density plots (Section 3.13). Now, we introduce another popular plot for visualizing the distribution of a continuous variable, namely the boxplot. Let’s say we want to generate a boxplot for the variable sale_price in the sahp dataset. 3.14.1 Using the boxplot() function To generate a boxplot, you can just use boxplot() with the variable as the argument. library(r02pro) sale_price &lt;- na.omit(sahp$sale_price) boxplot(sale_price) The boxplot compactly summarize the distribution of a continuous variable by visualizing five summary statistics (the median, two hinges, and two whiskers), and show all “outlying” points individually. All five summary statistics on the boxplot are related to the summary statistics we learned in Section 2.5. Let’s first review the summary function and the inter quartile range (IQR). summary(sale_price) #&gt; Min. 1st Qu. Median Mean 3rd Qu. Max. #&gt; 44.0 130.0 157.9 179.9 201.6 545.2 IQR(sale_price) #&gt; [1] 71.6125 Let’s discuss the five lines on the boxplot. The solid line in the middle represents the median value, which is 157.95. The lower solid line, also known as the lower hinge, is the first quartile Q1 = 129.9625. The upper solid line, also known as the upper hinge, is the third quartile Q3 = 201.575. The lower whisker is the smallest observation value that is greater than or equal to Q1 - 1.5 * IQR. To find this value, we first calculate Q1 - 1.5 * IQR = 22.54375. Then, the smallest observation larger than 22.54375 is lower_whisker_loc &lt;- which.min(sale_price &gt;= quantile(sale_price, 0.25) - 1.5 * IQR(sale_price)) sale_price[lower_whisker_loc] #&gt; [1] 130.5 The upper whisker is the largest observation value that is smaller than or equal to Q3 + 1.5 * IQR. Similarly, the value is upper_whisker_loc &lt;- which.max(sale_price &gt;= quantile(sale_price, 0.75) + 1.5 * IQR(sale_price)) sale_price[upper_whisker_loc] #&gt; [1] 344.133 To summarize, the five lines on the boxplot, from the top to bottom, are upper whisker (&lt;= Q3 + 1.5*IQR) upper hinge (Q3) median (50-th percentile) lower hinge (Q1) lower whisker (&gt;= Q1 - 1.5*IQR) For the observations that are larger than the upper whisker or smaller than the lower whisker, the points are shown individually as outliers. 3.14.2 Using the geom_boxplot() function As before, we will spend more time to discuss geom_boxplot() as it provides more functionality. Let’s first create the boxplot for sale_price. library(tidyverse) #&gt; ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ── #&gt; ✓ ggplot2 3.3.2 ✓ purrr 0.3.4 #&gt; ✓ tibble 3.0.4 ✓ dplyr 1.0.2 #&gt; ✓ tidyr 1.1.2 ✓ stringr 1.4.0 #&gt; ✓ readr 1.4.0 ✓ forcats 0.5.0 #&gt; ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ── #&gt; x dplyr::filter() masks stats::filter() #&gt; x dplyr::lag() masks stats::lag() ggplot(data = sahp) + geom_boxplot(aes(x = &quot;&quot;, y = sale_price)) #&gt; Warning: Removed 1 rows containing non-finite values (stat_boxplot). Note that here we set x = \"\" since no information is needed on the x-axis. In addition to the default summary statistics, we can add other values to the boxplot, for example, we can add the mean value to the plot. ggplot(data = sahp, aes(x = &quot;&quot;, y = sale_price)) + geom_boxplot() + geom_point(stat = &quot;summary&quot;, fun = &quot;mean&quot;, shape = 20, size = 4, color = &quot;red&quot;) #&gt; Warning: Removed 1 rows containing non-finite values (stat_boxplot). #&gt; Warning: Removed 1 rows containing non-finite values (stat_summary). The geom_point() function will first calculate the mean hwy, and add it to the boxplot. Note that we used some global aesthetics for geom_point(). 3.14.3 Compare distributions in different groups One common use of boxplot is to compare the distribution of a continuous variable in different groups. To do this, you just need to set the x-axis to be the discrete variable that encodes the different groups. Let’s say we want to compare the sale_price for houses with different kit_qual. ggplot(data = sahp) + geom_boxplot(aes(x = kit_qual, y = sale_price)) #&gt; Warning: Removed 1 rows containing non-finite values (stat_boxplot). This plot shows the boxplots of sale_price for different values of kit_qual side-by-side, which makes the comparison of distributions straightforward. Just like in bar charts, you may want to arrange the boxplots in a particular order. For example, to order the boxplots in ascending order of the sale_price, you can use ggplot(data = remove_missing(sahp, vars = &quot;sale_price&quot;)) + geom_boxplot(aes(x = fct_reorder(kit_qual, sale_price, median), y = sale_price)) #&gt; Warning: Removed 1 rows containing missing values. To order it by the mean sale_price in descending order, you can use ggplot(data = remove_missing(sahp, vars = &quot;sale_price&quot;)) + geom_boxplot(aes(x = fct_reorder(kit_qual, sale_price, mean, .desc = TRUE), y = sale_price)) #&gt; Warning: Removed 1 rows containing missing values. If you want to generate a flipped version of the boxplot, you can add coord_flip() to the ggplot() function. Actually, this works with any ggplot. ggplot(data = sahp) + geom_boxplot(aes(x = kit_qual, y = sale_price)) + coord_flip() As an alternative, you can also switch the x and y arguments. ggplot(data = sahp) + geom_boxplot(aes(x = sale_price, y = kit_qual)) Now, you have learned how to compare the distributions of a continuous variable for different groups implied by a discrete variable. How about groups implied by a continuous variable? To do this, you can use the function cut_width() to convert a continuous variable to a discrete one by dividing the observations into different groups, just like in histograms. cut_width(sahp$oa_qual, 2) #&gt; [1] (5,7] (5,7] (3,5] (3,5] (5,7] (5,7] (5,7] (3,5] (3,5] (3,5] #&gt; [11] (5,7] (5,7] (3,5] (7,9] (5,7] (3,5] (3,5] (3,5] (5,7] (5,7] #&gt; [21] (3,5] (7,9] (7,9] &lt;NA&gt; (5,7] (3,5] (3,5] (3,5] (3,5] (7,9] #&gt; [31] (7,9] (7,9] (5,7] (7,9] (5,7] (3,5] (5,7] (5,7] (3,5] (3,5] #&gt; [41] (9,11] (3,5] (3,5] (3,5] (7,9] (3,5] (5,7] (3,5] (5,7] (5,7] #&gt; [51] (3,5] (5,7] (5,7] (3,5] (5,7] (5,7] (7,9] (7,9] (3,5] (5,7] #&gt; [61] (5,7] (5,7] (5,7] (5,7] (3,5] (3,5] (5,7] (5,7] (3,5] (5,7] #&gt; [71] (5,7] (3,5] (7,9] (5,7] (3,5] (7,9] (7,9] (3,5] [1,3] (5,7] #&gt; [81] (5,7] (5,7] (3,5] (5,7] (5,7] (3,5] (3,5] (5,7] (3,5] (3,5] #&gt; [91] (7,9] (5,7] (5,7] (5,7] (5,7] (3,5] (5,7] (3,5] (9,11] (5,7] #&gt; [101] (5,7] (7,9] (3,5] (5,7] (3,5] (5,7] (5,7] (3,5] (3,5] (5,7] #&gt; [111] (5,7] (5,7] (7,9] (7,9] (7,9] (5,7] (7,9] (5,7] (5,7] (5,7] #&gt; [121] (5,7] (5,7] (3,5] (3,5] (5,7] (5,7] (3,5] (7,9] (5,7] (5,7] #&gt; [131] (3,5] (7,9] (5,7] (5,7] (5,7] (5,7] (5,7] [1,3] (3,5] (5,7] #&gt; [141] (3,5] (5,7] (5,7] (3,5] (3,5] (3,5] (3,5] (3,5] (3,5] (5,7] #&gt; [151] (7,9] (7,9] (3,5] (5,7] (7,9] [1,3] (7,9] (7,9] (5,7] (5,7] #&gt; [161] (7,9] (5,7] (3,5] (5,7] (3,5] #&gt; Levels: [1,3] (3,5] (5,7] (7,9] (9,11] 3.14.4 Map aesthetics to boxplot Before talking about aesthetics, let’s create a boxplot of sale_price for different values of house_style. ggplot(data = na.omit(sahp), aes(x = house_style, y = sale_price)) + geom_boxplot() + scale_x_discrete(limits=c(&quot;1Story&quot;, &quot;2Story&quot;)) Note that we only show the two boxplots with house_style equaling \"1Story\" or \"2Story\". To simply the codes, it is sometimes helpful to store the intermediate plot object and build additional plots on top of it. For example, we can generate the same boxplot using the following two steps. g &lt;- ggplot(data = na.omit(sahp), aes(x = house_style, y = sale_price)) + scale_x_discrete(limits=c(&quot;1Story&quot;, &quot;2Story&quot;)) g + geom_boxplot() #&gt; Warning: Removed 34 rows containing missing values (stat_boxplot). a. map the grouping variable to color First, let’s try to map the variable house_style to the color aesthetic. g + geom_boxplot(mapping=aes(color = house_style)) b. map the grouping variable to fill g + geom_boxplot(mapping=aes(fill = house_style)) c. map a third variable to color g + geom_boxplot(mapping=aes(color = oa_qual &gt; 5)) d. map a third variable to fill g + geom_boxplot(mapping=aes(fill = oa_qual &gt; 5)) e. global aesthetics g + geom_boxplot(fill = &quot;green&quot;, color = &quot;red&quot;) g + geom_boxplot(outlier.color = &quot;green&quot;, outlier.shape = 2, outlier.size = 3) "]]
